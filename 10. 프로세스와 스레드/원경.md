# Chapter 10. 프로세스와 스레드
## 10-1. 프로세스 개요
- 실행 중인 프로그램 = 프로세스
- 사용자와 직접 상호작용하는 프로세스 → 포그라운드
- 백그라운드에서 동작 → 유닉스: 데몬 / 윈도우: 서비스

### 프로세스 제어 블록 (PCB)
- 운영체제가 프로세스를 식별하고 관리하기 위해 사용하는 자료 구조
- 커널 영역에 생성되며, 프로세스 생성 시 생성되고 종료 시 폐기

|구성 요소|설명|
|---|---|
|PID|고유 프로세스 ID|
|레지스터 값|프로그램 카운터 등 현재 실행 상태 정보|
|상태 정보|실행, 대기 등 현재 상태|
|스케줄링 정보|우선순위, 대기 시간 등|
|메모리 정보|주소 범위, 페이지 테이블 등|
|파일/장치 목록|열려 있는 파일, 사용 중인 장치 등|

### 문맥 교환
- 실행 중인 프로세스의 상태를 PCB에 저장하고, 다른 프로세스를 복원해 실행하는 절차
- 빠른 전환 덕분에 사용자에겐 동시 실행처럼 보임
- 교환이 잦으면 오버헤드 발생 가능

### 프로세스의 메모리 영역

|영역|설명|
|---|---|
|코드(Code)|기계어로 된 명령어 저장, 읽기 전용|
|데이터(Data)|전역 변수 등 프로그램 전체 실행 중 유지되는 데이터|
|힙(Heap)|개발자가 직접 할당/해제, 크기 변동 가능, 누수 가능성 존재|
|스택(Stack)|지역 변수, 매개변수 등 임시 데이터 저장. 힙과 반대 방향 성장|

> 힙과 스택은 서로 반대 방향으로 성장하여 충돌 방지

## 10-2. 프로세스 상태와 계층 구조
### 프로세스 상태

|상태|설명|
|---|---|
|생성|생성 중인 상태|
|준비|CPU 할당 대기 중|
|실행|CPU 사용 중|
|대기|입출력 또는 이벤트 대기|
|종료|실행 완료 후 정리 중|

> 상태 전이는 인터럽트, 시스템 호출 등에 의해 발생

### 프로세스 계층 구조
- 실행 도중 시스템 호출을 통해 다른 프로세스를 생성할 수 있다
- 생성한 프로세스를 부모 프로세스 부모 프로세스에 의해 생성된 프로세스를 자식 프로세스라고 부른다
- 자식 프로세스의 PCB에 부모 프로세스의 pid인 ppid 가 기록되기도 한다
- 이러한 과정을 반복해서 나오는 것을 도표로 그리면 트리 구조를 띠는데 이를 프로세스 계층 구조라고 한다

### 프로세스 생성 기법
- 프로세스는 다른 프로세스를 생성 가능
- 부모 → 자식 관계로 트리 형태 구성
- 자식 프로세스는 부모의 PID를 PPID로 가짐
- `fork()`: 부모 프로세스 복제 → 자식 생성
- `exec()`: 자식의 메모리 공간을 새로운 프로그램으로 덮어쓰기
- 대부분의 운영체제는 이 조합으로 프로세스 생성


## 10-3 스레드
- 실행 흐름의 최소 단위
- 하나의 프로세스 내에서 다수의 스레드가 동시에 실행 가능

### 프로세스와 스레드

|항목|프로세스|스레드|
|---|---|---|
|자원|독립적 (메모리, 파일 등 분리)|동일 프로세스 내 자원 공유|
|ID|고유 PID|고유 TID (Thread ID)|
|비용|생성, 전환 비용 큼|비용 작고 효율적|
|안정성|하나 문제 발생 시 영향 작음|하나 오류 시 전체 프로세스 영향 가능|

> 스레드는 프로세스의 메모리 공간을 공유하므로 협업 유리하지만, 오류 전파 위험도 큼

### 멀티프로세스와 멀티스레드
- 멀티프로세스: 독립적, 안정성 높음, 자원 공유 어려움
- 멀티스레드: 자원 공유 쉬움, 효율성 높음, 오류 전파 가능성 있음
- 프로세스 간 통신 (IPC)
    - 프로세스 간 자원 공유 및 데이터 교환 방법
    - 주요 방식: 파일, 공유 메모리, 파이프, 소켓 등
    - 예: 하나는 파일에 쓰고, 다른 하나는 같은 파일을 읽는 구조

> 프로세스는 실행 중인 프로그램, 스레드는 그 내부의 실행 흐름 단위.  
> 메모리 구조, 상태 전이, 생성 방식 등 운영체제의 자원 관리 방식은 모두 프로세스를 중심으로 이루어지며,
> 스레드는 효율성과 병렬성을 위한 확장된 구조로 활용됨.
