# Ch.13 교착상태

## 13-1. 교착 상태란

**교착상태**란 일어나지 않을 사건을 기다리며 진행이 멈춰버리는 상태를 말한다.

1. 교착 상태가 발생했을 때의 상황
    
    **자원 할당 그래프**를 통해 표현할 수 있는데, 여기서 자원 할당 그래프란 어떤 프로세스가 어떤 자원을 사용하고 있고, 또 어떤 프로세스가 어떤 자원을 기다리고 있는지를 표현하는 간단한 그래프를 말한다.
    
    교착상태가 일어난 그래프의 특징은 자원할당 그래프가 원의 형태를 띄고 있다.
    

1. 교착 상태가 일어나는 이유
    
    교착 상태가 발생할 조건은 **상호 배제, 점유와 대기, 비선점, 원형 대기** 이렇게 네 가지이다.
    
    - 상호 배제: 한 프로세스가 사용하는 자원을 다른 프로세스가 사용할 수 없는 상태
    - 점유와 대기: 자원을 할당 받은 상태에서 다른 자원을 할당 받기를 기다리는 상태
    - 비선점: 어떤 프로세스도 다른 프로세스의 자원을 강제로 빼앗지 못하는 상태
    - 원형 대기: 프로세스들이 원의 형태로 자원을 대기하는 상태
    
    여기서 네 가지 조건 중 하나라도 만족하지 않으면 교착 상태가 발생하지 않고 네 가지 조건을 모두 만족하면 교착 상태가 발생할 수 있다.
    

## 13-2. 교착 상태 해결 방법

1. 교착 상태 예방
    
    애초에 교착 상태가 발생하지 않도록 하면 교착 상태를 예방할 수 있다.
    
    교착 상태의 발생 조건 중 하나를 없애버리면 된다.
    
    - 상호 배제를 없애면?
        
        모든 자원을 공유하게 만드는 것과 같은 말이다. 이론적으로는 가능하지만 현실적으로는 불가능하다.
        
    - 점유와 대기를 없애면?
        
        특정 프로세스에 자원을 모두 할당하거나 아예 할당하지 않는 방식으로 배분. 이론적으로는 가능하지만 자원의 활용률이 낮아지는 단점이 있다.
        
    - 비선점 조건을 없애면?
        
        선점이 가능한 자원 (ex. CPU)에 한해 효과적이다. 하지만 모든 자원이 선점이 가능한 것은 아니다.
        
    - 원형 대기 조건을 없애면?
        
        자원에 번호를 붙이고 오름차순으로 할당하면 원형 대기는 발생하지 않는다. 하지만 어떤 자원에 어떤 번호를 붙이느냐에 따라 활용률이 달라진다는 단점이 있다.
        
    
    → 교착 상태가 발생하지 않음은 보장할 수 있으나 부작용이 따르는 방식이다.
    
2. 교착 상태 회피
    
    교착 상태를 무분별한 자원 할당으로 인해 발생했다고 간주한다. 배분할 수 있는 자원의 양을 고려해서 교착 상태가 발생하지 않을 만큼만 자원을 배분하는 방식이다.
    
    - 안전 순서열: 교착 상태 없이 안전하게 프로세스들에 자원을 할당할 수 있는 순서
    - 안전 상태: 교착 상태 없이 모든 프로세스가 자원을 할당 받고 종료될 수 있는 상태
        - 안전 순서열이 있는 상태
    - 불안전 상태: 교착 상태가 발생할 수도 있는 상태
        - 안전 순서열이 없는 상태
3. 교착 상태 검출 후 회복
    
    교착 상태 발생을 인정하고 사후에 조치하는 방식이다.
    
    - 선점을 통한 회복
        
        교착 상태가 해결될 때 까지 한 프로세스씩 자원을 몰아주는 방식
        
    - 프로세스 강제 종료를 통한 회복
        - 교착 상태에 높인 프로세스 모두 강제 종료 (→ 작업 내역을 잃을 위험)
        - 교착 상태가 해결될 때 까지 한 프로세스씩 강제 종료 (→ 오버헤드)
